# Hibernate


### Hibernate
Hibernate는 Java용 오픈 소스 객체 관계형 매핑(ORM) 프레임워크입니다. 객체 지향 도메인 모델을 관계형 데이터베이스에 매핑하는 편리하고 효율적인 방법을 제공하여 개발자가 객체 지향 방식으로 영구 데이터로 작업할 수 있도록 합니다.

Hibernate는 데이터베이스 연결, 트랜잭션 및 SQL 쿼리의 저수준 세부 정보를 추상화하여 데이터베이스 상호 작용을 단순화합니다. 객체 관계형 매핑 계층을 제공하여 개발자가 Java 클래스와 데이터베이스 테이블 간의 매핑을 정의할 수 있도록 하고 객체 지향 데이터 모델과 데이터베이스에 저장된 관계형 데이터 간의 변환을 처리합니다.

Hibernate의 주요 기능 및 이점은 다음과 같습니다.

1. ORM(Object-Relational Mapping): Hibernate는 개발자가 저수준 SQL 쿼리를 작성할 필요 없이 Java 객체를 데이터베이스 테이블에 매핑하거나 그 반대로 매핑하는 메커니즘을 제공합니다. 이는 데이터베이스 작업을 단순화하고 개발자가 친숙한 개체 지향 프로그래밍 개념으로 작업할 수 있도록 합니다.

2. 데이터베이스 독립성: Hibernate는 기본 데이터베이스를 추상화하여 특정 데이터베이스 공급업체와 독립적으로 애플리케이션을 개발할 수 있도록 합니다. MySQL, PostgreSQL, Oracle, SQL Server 등과 같은 광범위한 관계형 데이터베이스를 지원합니다.

3. 자동 CRUD 작업: Hibernate는 레코드 생성, 검색, 업데이트 및 삭제(CRUD)와 같은 일반적인 데이터베이스 작업을 단순화합니다. 엔터티 클래스에 정의된 매핑을 기반으로 SQL 문을 생성하므로 반복적인 SQL 코드 작성의 필요성이 줄어듭니다.

4. 캐싱 및 성능 최적화: Hibernate에는 데이터베이스 왕복을 줄여 성능을 향상시키는 캐싱 메커니즘이 포함되어 있습니다. 애플리케이션 성능을 크게 향상시킬 수 있는 첫 번째 수준(세션 수준) 캐시와 두 번째 수준(공유) 캐시를 포함하여 다양한 수준의 캐싱을 지원합니다.

5. 트랜잭션 관리: Hibernate는 JTA(Java Transaction API) 또는 Spring과 같은 트랜잭션 관리 프레임워크와 통합되어 개발자가 데이터베이스 트랜잭션을 쉽게 관리할 수 있도록 합니다. 원자성 및 격리된 데이터베이스 작업을 지원하여 데이터 무결성과 일관성을 보장합니다.

6. 쿼리 언어: Hibernate는 SQL과 유사하지만 데이터베이스 테이블이 아닌 엔터티 객체에서 작동하는 객체 지향 쿼리 언어인 HQL(Hibernate Query Language)을 제공합니다. HQL은 개발자가 보다 자연스럽고 읽기 쉬운 방식으로 복잡한 쿼리를 표현할 수 있도록 하여 쿼리를 단순화합니다.

7. Java EE 및 Spring과의 통합: Hibernate는 Java Enterprise Edition(Java EE) 애플리케이션 및 Spring Framework와 원활하게 통합될 수 있으므로 엔터프라이즈 환경에서 데이터베이스 액세스를 위한 대중적인 선택이 됩니다.

Hibernate를 활용함으로써 개발자는 애플리케이션의 비즈니스 논리에 더 집중하고 데이터베이스 상호 작용과 관련된 상용구 코드의 양을 줄일 수 있습니다. 프레임워크 내에서 데이터베이스 액세스 논리를 캡슐화하여 코드 재사용성, 유지 관리성 및 이식성을 촉진합니다.

전반적으로 Hibernate는 데이터베이스 작업을 단순화하고 개발자가 Java 애플리케이션에서 보다 객체 지향적인 방식으로 영구 데이터로 작업할 수 있도록 하는 널리 사용되는 성숙한 ORM 프레임워크입니다.


### 데이터 모델 / 객체 모델
JPA(Java Persistence API) 컨텍스트에서 "데이터 모델" 및 "객체 모델"이라는 용어는 애플리케이션 내 데이터의 두 가지 다른 관점 또는 표현을 나타냅니다.

1. 데이터 모델:
엔터티 데이터 모델이라고도 하는 데이터 모델은 관계형 데이터베이스에서 데이터의 구조와 관계를 나타냅니다. 엔터티, 특성 및 연결의 개념을 사용하여 테이블, 열 및 테이블 간의 관계를 정의합니다. 데이터 모델은 일반적으로 데이터베이스 스키마 또는 데이터 정의 언어(DDL)를 사용하여 표현됩니다.

JPA에서 데이터 모델은 엔티티 클래스라고 하는 Java 클래스의 주석 또는 XML 매핑을 통해 정의됩니다. 이러한 엔터티 클래스는 데이터베이스 테이블에 해당하며 해당 특성은 테이블 열에 매핑됩니다. 데이터 모델은 데이터베이스 스키마를 정의하는 방법과 응용 프로그램의 데이터를 저장하고 구성하는 방법을 제공합니다.

2. 개체 모델:
도메인 모델 또는 애플리케이션 모델이라고도 하는 개체 모델은 애플리케이션의 도메인 또는 비즈니스 개체의 구조와 동작을 나타냅니다. 응용 프로그램 도메인에 있는 개체 간의 클래스, 속성 및 관계를 정의합니다. 개체 모델은 일반적으로 클래스, 특성 및 연결과 같은 개체 지향 개념을 사용하여 표현됩니다.

JPA에서 개체 모델은 종종 엔터티 클래스 또는 도메인 클래스라고 하는 Java 클래스로 표시됩니다. 이러한 클래스는 애플리케이션의 비즈니스 논리와 동작을 캡슐화합니다. 개체 모델은 기본 데이터 저장 메커니즘과 관계없이 응용 프로그램의 데이터 개체와 해당 관계를 정의하는 방법을 제공합니다.

JPA는 필요한 매핑 메커니즘을 제공하여 데이터 모델과 개체 모델 간의 격차를 해소합니다. JPA를 통해 개발자는 엔터티 클래스와 데이터베이스 테이블 간의 매핑은 물론 엔터티 간의 관계를 정의하여 데이터베이스에서 개체를 완벽하게 유지하고 검색할 수 있습니다.

JPA를 사용하면 개발자가 매핑 및 지속성 측면을 투명하게 처리하면서 개체 모델로 작업할 수 있으므로 개체 모델의 개체에 대한 변경 사항이 데이터 모델의 해당 데이터와 적절하게 동기화됩니다.

데이터 모델을 개체 모델에서 분리함으로써 JPA는 유연성과 추상화를 제공하여 개발자가 데이터 저장 및 검색을 위한 관계형 데이터베이스의 기능을 활용하면서 애플리케이션의 비즈니스 논리 및 동작에 집중할 수 있도록 합니다.


### entityManager
JPA(Java Persistence API)에서 'EntityManager'는 JPA 프레임워크에서 제공하는 핵심 인터페이스입니다. 지속성 컨텍스트와 상호 작용하고 엔터티 유지, 검색, 업데이트 및 삭제와 같은 데이터베이스 작업을 수행하기 위한 기본 인터페이스 역할을 합니다.

`EntityManager`는 JPA 애플리케이션 내 엔티티의 라이프사이클 관리를 담당합니다. 응용 프로그램과 기본 데이터베이스 간의 다리 역할을 하여 다양한 데이터베이스 작업을 수행하는 일련의 메서드를 제공합니다. `EntityManager`의 주요 책임 중 일부는 다음과 같습니다.

1. 엔터티 작업: 'EntityManager'는 엔터티를 유지, 병합, 제거 및 새로 고치는 메서드를 제공합니다. 이러한 작업을 통해 새 엔터티를 만들고, 기존 엔터티를 업데이트하고, 엔터티를 삭제하고, 엔터티 상태를 데이터베이스와 동기화할 수 있습니다.

2. 쿼리: `EntityManager`는 JPQL(Java Persistence Query Language) 또는 기본 SQL 쿼리를 사용하여 데이터베이스 쿼리를 지원합니다. 'createQuery()' 또는 'createNativeQuery()'와 같은 메서드를 제공하여 쿼리를 생성하고 쿼리 결과를 검색합니다.

3. 트랜잭션 관리: 'EntityManager'는 관리되는 엔터티 집합 및 관련 상태를 나타내는 지속성 컨텍스트와 연결됩니다. `EntityManager`는 트랜잭션에 참여하고 트랜잭션 경계 내에서 지속성 컨텍스트를 관리합니다. 트랜잭션이 커밋되는 동안 엔터티에 대한 변경 사항이 데이터베이스와 적절하게 동기화되도록 합니다.

4. 캐싱: JPA에는 'EntityManager'와 연결된 지속성 컨텍스트로 알려진 첫 번째 수준 캐시가 포함되어 있습니다. 'EntityManager'는 이 캐시를 관리하여 엔티티를 효율적으로 검색하고 저장할 수 있습니다. 캐시는 데이터베이스 액세스 수를 줄여 성능을 향상시키는 데 도움이 됩니다.

5. 관계 관리: JPA는 일대일, 일대다 또는 다대다 관계와 같은 엔터티 간의 관계 정의를 지원합니다. 'EntityManager'는 연결 설정, 관련 엔터티 가져오기 및 참조 무결성 유지를 포함하여 이러한 관계를 관리하는 메서드를 제공합니다.

`EntityManager`를 사용하려면 일반적으로 Hibernate 또는 EclipseLink와 같은 JPA 공급자로부터 직접 또는 Spring과 같은 종속성 주입 프레임워크를 통해 인스턴스를 얻습니다. `EntityManager` 인스턴스가 있으면 해당 메서드를 사용하여 CRUD 작업을 수행하고, 쿼리를 실행하고, 트랜잭션을 관리하고, 엔터티 관계를 처리할 수 있습니다.

`EntityManager`는 스레드로부터 안전하지 않으며 각 스레드 또는 트랜잭션에는 고유한 `EntityManager` 인스턴스가 있어야 합니다. 또한 'EntityManager'는 일반적으로 특정 데이터베이스에 대한 구성 및 연결 설정을 나타내는 지속성 단위와 연결됩니다.

전반적으로 'EntityManager'는 지속성 컨텍스트와 상호 작용하고 JPA 애플리케이션 내에서 엔터티를 관리하는 데 필요한 메서드와 기능을 제공하는 JPA의 중앙 인터페이스입니다.

### 트랜잭션
트랜잭션은 일반적으로 관계형 데이터베이스에 대해 실행되는 하나 이상의 데이터베이스 작업으로 구성된 논리적 작업 단위입니다. 이는 데이터 일관성과 무결성을 보장하면서 분할할 수 없는 단일 단위로 수행해야 하는 일련의 작업을 나타냅니다.

데이터베이스 관리 시스템의 맥락에서 트랜잭션은 트랜잭션 내의 모든 작업이 성공적으로 완료되거나 적용되지 않음을 보장합니다. 트랜잭션은 종종 ACID 속성이라고 하는 다음과 같은 주요 속성을 제공합니다.

1. 원자성: 원자성은 트랜잭션이 분리할 수 없는 단일 작업 단위로 취급되도록 합니다. 트랜잭션 내에서 이루어진 모든 변경 사항이 데이터베이스에 커밋되거나 아무 것도 커밋되지 않습니다. 트랜잭션의 일부가 실패하거나 오류가 발생하면 전체 트랜잭션이 롤백되고 모든 변경 사항이 취소됩니다.

2. 일관성: 일관성은 트랜잭션이 데이터베이스를 일관된 상태에서 다른 상태로 가져오는 것을 보장합니다. 데이터베이스 스키마에 정의된 무결성 제약 조건, 비즈니스 규칙 및 관계는 트랜잭션 전체에서 유지됩니다. 이는 데이터베이스가 트랜잭션 전후에 유효한 상태로 유지됨을 의미합니다.

3. 격리: 격리는 동시 트랜잭션이 서로 간섭하지 않도록 합니다. 각 트랜잭션은 다른 동시 트랜잭션과 관계없이 격리되어 실행된 것처럼 작동합니다. 트랜잭션 내에서 변경된 사항은 트랜잭션이 커밋될 때까지 다른 트랜잭션에 표시되지 않으므로 더 높은 수준의 데이터 무결성을 제공하고 데이터 불일치를 방지합니다.

4. 내구성: 내구성은 트랜잭션이 커밋되면 트랜잭션 내에서 변경된 사항이 영구적으로 저장되고 후속 시스템 오류 또는 충돌이 발생하더라도 지속됨을 보장합니다. 커밋된 데이터는 데이터베이스의 영구적인 부분이 되며 오류 발생 시 복구할 수 있습니다.

트랜잭션은 여러 사용자 또는 응용 프로그램이 동일한 데이터베이스에 동시에 액세스하고 수정하는 다중 사용자 환경에서 데이터 무결성과 일관성을 유지하는 데 도움이 됩니다. 관련 데이터베이스 작업을 트랜잭션으로 그룹화하면 동시 액세스가 있는 경우에도 데이터베이스가 유효하고 일관된 상태로 유지되도록 할 수 있습니다.

JPA(Java Persistence API)를 사용하는 Java 애플리케이션에서 트랜잭션은 일반적으로 기본 JPA 구현 또는 JTA(Java Transaction API) 또는 Spring과 같은 트랜잭션 관리 프레임워크에 의해 관리됩니다. 트랜잭션 관리 프레임워크는 정의된 트랜잭션 경계를 기반으로 트랜잭션의 시작, 커밋 또는 롤백을 처리합니다.

트랜잭션을 사용하면 응용 프로그램에서 데이터 작업의 안정성과 무결성을 보장하여 복잡한 작업을 단일 논리적 작업 단위로 처리할 수 있는 방법을 제공할 수 있습니다.

### JPQL
JPQL(Java Persistence Query Language)은 JPA(Java Persistence API) 전용 쿼리 언어입니다. 객체 지향 개념을 사용하여 관계형 데이터베이스에 저장된 데이터를 쿼리하고 조작하는 표준화된 방법을 제공합니다.

JPQL은 SQL(Structured Query Language)과 유사하지만 테이블 및 열에서 작동하는 대신 개체 모델에 정의된 엔터티 및 속성에서 작동합니다. 이를 통해 개발자는 기본 데이터베이스 세부 정보를 추상화하여 플랫폼 독립적인 방식으로 쿼리를 표현할 수 있습니다.

JPQL의 일부 주요 기능은 다음과 같습니다.

1. 엔터티 중심 쿼리: JPQL을 사용하면 개체 모델에 정의된 특성, 관계 및 연결을 기반으로 엔터티를 쿼리할 수 있습니다. 엔터티를 일급 시민으로 취급하여 쿼리에서 개체 관계를 탐색할 수 있습니다.

2. 객체 지향 구문: JPQL은 SQL과 유사한 객체 지향 구문을 사용하여 데이터 필터링, 순서 지정, 그룹화 및 집계와 같은 다양한 작업을 수행할 수 있습니다. 쿼리를 구성하기 위한 일련의 키워드 및 연산자를 제공합니다.

3. 플랫폼 독립성: JPQL은 기본 데이터베이스 시스템과 독립적입니다. 데이터베이스별 SQL 구문을 추상화하여 수정 없이 다른 데이터베이스에서 실행할 수 있는 이식 가능한 쿼리를 작성할 수 있습니다.

4. 유형 안전성: JPQL은 컴파일 시간에 유형 검사를 제공하여 쿼리가 컴파일 시간에 구문 및 의미론적으로 올바른지 확인합니다. 이는 개발 프로세스 초기에 오류를 감지하고 코드 안정성을 향상시키는 데 도움이 됩니다.

5. 명명된 쿼리: JPQL은 엔터티 클래스와 관련된 미리 정의된 쿼리인 명명된 쿼리를 지원합니다. 명명된 쿼리를 사용하면 중앙 집중식 위치에서 일반적으로 사용되는 쿼리를 정의하여 코드 유지 관리 및 재사용성을 개선할 수 있습니다.

6. 조인 및 하위 쿼리 지원: JPQL은 여러 엔터티에서 데이터를 검색하기 위해 다양한 유형의 조인(예: 내부 조인, 왼쪽 외부 조인)을 지원합니다. 또한 보다 복잡한 필터링 및 데이터 검색을 위해 쿼리 내에서 하위 쿼리를 사용할 수 있습니다.

JPA의 `EntityManager` 인터페이스에서 제공하는 `createQuery()` 메서드를 사용하여 JPQL 쿼리를 실행할 수 있습니다. 쿼리 결과는 요구 사항에 따라 엔터티 컬렉션 또는 스칼라 값으로 반환될 수 있습니다.

다음은 JPQL 쿼리의 예입니다.

```자바
String jpqlQuery = "SELECT e FROM Employee e WHERE e.department = :dept";
TypedQuery<Employee> query = entityManager.createQuery(jpqlQuery, Employee.class);
query.setParameter("dept", department);
List<Employee> employees = query.getResultList();
```

이 예에서 JPQL 쿼리는 특정 부서를 기준으로 필터링하여 데이터베이스에서 'Employee' 엔터티 목록을 검색합니다.

JPQL은 JPA 애플리케이션에서 데이터를 쿼리하고 조작하기 위한 강력한 도구입니다. 데이터 검색에 대한 표준화된 개체 지향 접근 방식을 제공하여 플랫폼 독립적인 방식으로 영구 엔터티로 작업하기가 더 쉽습니다.




## 학습 키워드
- Hibernate
- 데이터 모델 / 객체 모델
- entityManager
- 트랜잭션
- JPQL