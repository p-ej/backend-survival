# Collection Pattern 적용


### Collection Pattern 
- 목록 혹은 그룹과 같은 리소스 컬렉션을 조작하는데 사용되는 일반적인 디자인 패턴이다. (Restful API)
- 이 패턴은 리소스 컬렉션과 상호 작용을 위해 URL구조 및 HTTP 메서드 생성 가이드 지침을 따른다.
- 또 리소스 컬렉션을 중심으로 REST API에서 끝점(EndPoint) 구성을 한다.
    - 개별적 리소스에 대한 엔드포인트가 아니다.
    - 리소스 모음에 대한 엔드포인트
    - 예 : 개별 게시판 검색, (생성, 삭제, 업데이트) 만을 위한 것이 아니다.
    - 게시판 컬렉션 검색, 생성, 업데이트, 삭제가 되어야 한다. (리소스 컬렉션 기준으로 구성되는?)


### 패턴 적용 단계
1. 컬렉션에 대한 URL 구조 선택하기
    - 일반적으로는 리소스 이름을 복수형으로한다. 
    - 유저 컬렉션 : """/users"""
2. HTTP 메서드를 사용해 컬렉션과 상호 작용하기
    - 통상적으로 사용하는 메서드는 GET, POST, PUT, DELETE가 있다.
    - GET은 리소스를 얻어올때 : GET /users (유저목록 가져오기)
    - POST는 새로운 리소스를 생성할때 : POST /users (생성을 위해 입력할 데이터는 보통 request body에 담길것이다.)
    - PUT은 리소스를 업데이트 할때 (수정) : PUT /users/:id (POST와 같은 맥락, 여기서 특정 컬렉션을 구분지어야하니 id를 전달한다)
    - DELETE는 리소스를 삭제할 때 : DELETE /users/:id
3. 쿼리 파라미터를 사용해서 컬렉션을 필터링하거나 정렬 등 하기
    - 게시글을 가져오지만 제목을 검색해서 가져오고 싶은경우가 있다.
    - /boards?title=abc
    - 이렇게 컬렉션을 필터링해서 제목중 검색할 문자가 들어간 제목을 가진 게시글만 가져오게 할 수 있다.
    - 이를 이용해서 게시글 정렬도 가능하다.

> 이렇게 단계별로 API를 구성해 나가면 될듯하다. (유저 리소스, 게시글 리소스 등등)

### CQS?
- 기본 개념은 명령과 쿼리가 서로 다른 요구 사항을 가지며 다르게 처리되어야 한다는 것
- 이해한 바로는 읽어오는 명령에 생성과 수정작업이 같이 이루어지게 구성하지말고 **생성, 수정 작업을 분리**하여 구성하라는 것으로 이해했다. 
- 이 개념을 사용하여 Collection Pattern과 조합하면 좋은 API를 만들 수 있다는 것 같다.

### REST API & CQS
- 리소스 컬렉션을 중심으로 구성할 수 있다.
- 각 컬렉션에는 컬렉션에 대한 상호작용 되는 구성이 있을 것이고, CQS를 적용하면 컬렉션에 관련된 명령과 쿼리를 분리할 수 있다.
    - 컬렉션에 새로운 게시글을 추가(명령)하고 컬렉션의 게시글을 검색(쿼리)하기 위한 별도 함수가 있다.
    - CQS는 코드 가독성이나 테스트를 위한 유용한 설계 원칙같은 느낌
    - 약간 CQS는 내부 로직에 대한 패턴같다. 
- 이를 REST API와 결합함으로써 URL로 리소스도 구별가능하고 내부에서도 요청에 따른 작업이 분리되어 있으니 새로운 API를 생성하거나 기존 리소스에 새로운것을 추가할때 유용하지 않을까 싶다. 


## 학습 키워드
- CQS