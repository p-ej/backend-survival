# 인증

### Identifier
- 식별자는 애플리케이션 내에서 인증된 엔터티 또는 사용자를 고유하게 식별하는 정보이다.
- 사용자의 ID를 설정하고 응용 프로그램 전체에서 사용자의 상호 작용 또는 액세스 권한을 추적하는 데 사용된다.
- 일반적으로 인증 프로세스 중에 생성되며 세션 기간 동안 인증된 사용자와 연결된다.

#### 사용형태
1. 사용자 이름
  - 사용자가 자신을 식별하기 위해 인증 중에 제공하는 고유한 사용자 이름 또는 사용자 식별자이다. 
  - 종종 인증을 위해 암호와 결합된다.

2. 이메일 주소
  - 사용자의 이메일 주소는 인증을 위한 식별자 역할을 할 수 있다. 
  - 사용자와 연결하기 위해 고유하고 일반적으로 사용되는 식별자를 제공한다.

3. 사용자 ID
  - 애플리케이션 내에서 사용자를 고유하게 식별하는 시스템 생성 또는 할당 식별자이다. 
  - 정수, GUID(Globally Unique Identifier) 또는 고유성을 보장하는 기타 형식일 수 있다.

4. 토큰
  - 토큰 기반 인증에서는 인증 성공 시 토큰이 생성되며 후속 요청에 대한 식별자 역할을 한다. 
  - JWT(JSON Web Token), 액세스 토큰 또는 사용자 인증 및 권한 부여를 위한 각 요청과 함께 전송되는 세션 토큰일 수 있다.
  - **우리는 JWT를 사용하고 있다. AccessToken과 RefreshToken 전략을 사용중인데 지금도 그렇지만 처음에는 꽤나 애먹었던 기억이 있다.**

> - 무단 액세스 또는 오용을 방지하려면 이러한 식별자를 안전하게 처리하고 저장하는 것이 중요하다. 
> - 적절한 암호화, 안전한 저장, 신원 스푸핑 또는 변조에 대한 보호는 애플리케이션 수준 보안에서 인증 식별자의 보안을 유지하는 데 중요한 측면이다.


### PostgreSQL
1. 데이터 유형 및 기능
  - PostgreSQL은 배열, JSON 및 기하학 유형과 같은 고급 데이터 유형을 포함하여 더 넓은 범위의 데이터 유형을 지원한다. 
    - MySQL에는 더 제한된 데이터 유형 세트가 있다.
  - PostgreSQL은 내장된 전체 텍스트 검색, 지리 공간 지원, 재귀 쿼리 및 창 기능과 같은 복잡한 쿼리 지원과 같은 고급 기능을 제공한다. 
    - MySQL은 기능 세트가 더 간단하고 기존 SQL 기능에 더 중점을 둔다.

2. SQL 준수
  - PostgreSQL은 강력한 SQL 준수 및 ANSI SQL 표준 준수로 유명하다. 
  - SQL 기능에 대한 포괄적인 지원을 제공하며 SQL 표준을 완벽하게 준수한다. 
  - 반면에 MySQL은 SQL 표준에 대해 좀 더 완화된 접근 방식을 가지고 있으며 특정 영역에서 벗어날 수 있다.

3. 복제 및 고가용성
  - MySQL은 마스터-슬레이브 및 마스터-마스터 복제와 같은 다양한 복제 모드를 포함하여 강력한 복제 기능을 제공하는 오랜 역사를 가지고 있다. 
  - 고가용성 설정에 대한 기본 지원을 제공한다.
  - PostgreSQL도 복제를 지원하지만 역사적으로 복제 기능은 MySQL만큼 성숙하지 않았다. 그러나 최신 버전의 PostgreSQL은 논리적 복제 및 스트리밍 복제와 같은 기능을 포함하여 복제 기능을 크게 개선했다.

4. 성능 및 확장성
  - PostgreSQL과 MySQL은 모두 고성능이지만 워크로드 및 특정 구성에 따라 성능 특성이 다를 수 있다.  
  - 역사적으로 MySQL은 특히 MyISAM 스토리지 엔진을 사용하여 간단한 읽기 및 쓰기 작업을 처리하는 데 더 빠른 것으로 간주되었습니다. 그러나 최신 버전의 기본값인 InnoDB 스토리지 엔진을 사용하여 MySQL은 트랜잭션 워크로드에 대한 성능을 개선했다.
  - PostgreSQL은 종종 복잡한 쿼리 및 데이터 무결성 검사 성능으로 칭찬을 받는다. 고급 SQL 기능과 많은 데이터 조작이 필요한 시나리오에서 탁월하다.

5. 커뮤니티 및 생태계
  - MySQL은 광범위한 채택에 기여한 Oracle Corporation의 지원을 받는 크고 활동적인 커뮤니티를 보유하고 있다. 
  - 여기에는 주변에 구축된 도구, 라이브러리 및 프레임워크의 풍부한 생태계가 있다.
  - PostgreSQL은 또한 활발한 커뮤니티와 풍부한 생태계를 가지고 있지만 MySQL보다 약간 작을 수 있다. 그러나 PostgreSQL은 오픈 소스 개발 및 협업에 중점을 둔 강력한 커뮤니티 참여로 유명하다.

6. 라이선스
  - PostgreSQL은 허용적인 오픈 소스 라이선스인 PostgreSQL 라이선스에 따라 출시된다. 소프트웨어를 무료로 사용, 수정 및 배포할 수 있다.
  - MySQL은 GNU General Public License(GPL)에 따라 출시되는 Community Edition과 상업용 라이센스가 필요한 Enterprise Edition의 두 가지 주요 에디션으로 제공한다.


### OAuth 2.0
- 사용자가 자신의 자격 증명(사용자 이름 및 암호)을 제3자와 공유할 필요 없이 타사 응용 프로그램이 API와 같은 서버에서 사용자의 보호된 리소스에 대한 제한된 액세스 권한을 얻을 수 있도록 하는 개방형 표준 인증 프레임워크이다.
  - 쉽게 말하자면, 우리의 서비스가 우리 서비스를 이용하는 유저의 타사 플랫폼 정보에 접근하기 위해서 권한을 타사 플랫폼으로부터 위임 받는 것이라고 한다.

#### 흐름 
- 흐름에 대한 정의를 보자면 아래와 같다.
1. 클라이언트 등록
  - 클라이언트는 인증 서버에 등록하고 클라이언트를 식별하고 인증하는 데 사용되는 클라이언트 자격 증명(클라이언트 ID 및 클라이언트 암호)을 얻는다.

2. 권한 부여 요청
  - 클라이언트는 사용자를 권한 부여 서버의 권한 부여 끝점으로 리디렉션하여 특정 리소스에 대한 액세스를 요청한다. 
  - 요청에는 클라이언트 ID, 요청된 범위(권한) 및 리디렉션 URI가 포함된다.

3. 사용자 인증
  - 사용자는 인증 서버로 인증하고 클라이언트에 대한 액세스를 허용하거나 거부하라는 메시지가 표시된다. 
  - 사용자가 접근 권한을 부여하면 Authorization Server는 Authorization Code를 발급한다.

4. 액세스 토큰 요청
  - 클라이언트는 인증 코드, 클라이언트 자격 증명 및 리디렉션 URI를 포함하여 인증 서버의 토큰 끝점에 요청을 보낸다. 
  - 이에 대한 응답으로 권한 부여 서버는 액세스 토큰을 발행한다.

5. 보호된 리소스 액세스
  - 클라이언트는 리소스 서버의 API에 대한 후속 요청에 액세스 토큰을 포함한다. 
  - 리소스 서버는 토큰을 확인하고 토큰이 유효한 경우 요청된 리소스에 대한 액세스 권한을 부여한다.

### Bearer Token 옵션

### SecurityFilterChain

### `@Configuration`

### `@EnableWebSecurity`

### Filter vs OncePerRequestFilter

### FilterChain

### SecurityContext




## 학습 키워드
- Identifier
- **[PostgreSQL](https://www.postgresql.org/) (MySQL, MariaDB와 두드러지는 차별점)**
- OAuth 2.0
- Bearer Token 옵션
- SecurityFilterChain
- `@Configuration`
- `@EnableWebSecurity`
- Filter vs OncePerRequestFilter
- FilterChain
- SecurityContext