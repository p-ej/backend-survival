# Data Access


### 데이터 접근 계층관련하여
- 전 강의에서 계층 아키텍처를 적용하여 프리젠테이션 계층(컨트롤러)에서 서비스(애플리케이션) 계층으로 나눈바가 있다.
    - 기존 : Controller (통신 & 기능 & 데이터)
    - 계층 분리 : Controller (통신) -> Service (기능 & 데이터)
- 아직 DB연결까지 하진 않았지만, 서비스 계층에서 기능을 조작하고 데이터까지 담당하기에는 아직도 무언가 불편하다 
- Layered Architecture를 배움으로써 일반적인 구조는 3계층으로 나뉘는 것을 알게 되었고 이를 적용하고자 한다. 
- 그러면 Service에 존재하는 기능과 데이터를 분리(관심사 분리)한 아키텍처를 다시 구성한다.
- 최종적으로는 `계층 분리 : Controller (통신) -> Service (기능) -> Data Access(데이터 접근)`이런 형태가 된다.

#### 그럼 Data Access은 무엇인가?
- 프리젠테이션은 사용자의 상호작용을 인지하는 계층이고 서비스는 상호작용에 대한 기능 처리를 담당한다면, 데이터 액세스 계층은 상호작용에 대한 기능 처리에 필요한 데이터들을 C, R, U, D하는 역할을 한다고 이해했다.
- 결국은 데이터 스토리지 시스템 (DB 같은)와의 연결과 상호작용을 담당한다.
    - 데이터에 대한 것만 담당
- 컨트롤러는 서비스가 어떤 기능을 하는지 모르도록 하고 데이터 액세스는 데이터를 어떻게 처리하는지 서비스가 모르도록 구성하는 것이 좋다고 한다. (그리고 이것이 관심사의 분리이며 레이어 아키텍처 스타일이다.)
- Data Access 계층을 구현하기 위해서는 DAO 혹은 레포지토리 패턴 같은 것들을 사용하여 구성할 수 있다.

> - 나는 레포지토리 패턴을 사용중인데 솔직히 별차이 없다고 느껴졌다. 세부 차이점은 찾아보고 예시를 봐야 이해할 것 같다.
> - 데이터 액세스 계층에는 **데이터베이스 연결, 트랜잭션, 캐싱 및 기타 성능 관련 문제를 처리하기 위한 코드도 포함**한다고 한다.
   
강조되는 말이지만 **레이어 아키텍처를 구성하는 가장 주된 이유 중 하나는 유지 보수와 성능 그리고 쉬운 확장성을 위한 것이다.**

### DAO를 알아보아요 (Data Access Object)
- 쉽게 DB 데이터에 접근(데이터 액세스)하기 위한 객체라고 보면 된다.
- CRUD 작업을 수행하는데 필요한 코드와 담당하는 데이터 소스와 관련된 기타 데이터 접근 논리만 포함해야한다고 한다.
    - 그러니까 데이터 액세스 만의 역할에서 벗어나지 않도록 이 계층과 관련되지 않은 로직 논리는 존재해서는 안된다.

- 위에서 말했듯 서비스 계층이 데이터 상호작용에 대한 세부사항을 알 필요가 없다. 그럼 아래와 같이 구성될 것 같다.. (맞겠죠 ..?)
```java
@Service
// ...
private void userSave(UserDto userDto){
    userDao.save(userDto); // dao 왈 : 나한테 줘 내가 처리해줄게 라고 하는것 같다 ..?
}

// ...
```
- 그렇지만 사실 이 부분도 논리적인 범위라서 요구 사항에 따라 달라질 수 있다는 점이있다.
    - 비즈니스 로직이 포함될 수도 있다는 부분인 것 같다.
- 그래도! **일반적인 내용을 보면 최대한 역할을 분리 즉, 가능한만큼 제한하여 핵심 역할에 집중할 수 있도록 구성하자.** 가 될 것 같다.


### Map 과 List 
- 자바에는 컬렉션 프레임워크라는 것이 존재한다. 
- 상황에 따라 적절하게 쓰이는 자료구조인데 우리는 일반적으로 String, int, List 를 사용했지만 더 있다.
- 예를 들어 많은 데이터를 처리하기 위해 배열(List - 몇몇 언어에서는 배열과 다른 의미로 쓰이는 것으로 알고 있다.)을 사용했는데, 고정적인 길이와 삽입 혹은 삭제에 많은 시간이 들었다. 
- 이를 보완하기 위해 알고리즘을 적용하여 동적 배열로 만들거나 삽입, 삭제에 용이한 자료구조를 만드는 등을 통한것이 이 자바 컬렉션 프레임워크이다.


#### Map 
- 기본적으로 Key와 Value의 한 쌍으로 이루어진 데이터의 집합이다. 
- 또한 데이터의 구조는 중복 Key는 존재하지 않고 순서를 보장하지 않는다.
- 검색속도가 좋다.
- 인덱스는 따로 존재하지 않아서 interator라는 것을 사용한다.

> 일반적인 코드
```java
Map<String, String> map = new HashMap<String, String>();
```
- 보통 이렇게 HashMap을 바인딩 해주는데 Map도 여러 종류가 존재한다.
- 가장 많이 사용하는 것은 HashMap인 것 같다.
    - 추가 특징은 Key와 Value의 Null 허용
    - 검색에서 가장 좋은 성능을 보인다.


#### List
- 배열(Array)과 리스트는 다르다.
- 배열은 메모리 상에 데이터가 연속적이다.
- 리스트는 메모리 상에 데이터가 비연속적이다. 

`배열 (Array)` 
- 배열은 고정된 길이를 갖는다. 
- 배열 크기를 고정으로 지정하여 데이터를 저장한다.
    - 단점은 크기를 10으로 지정했을 때 데이터를 5개뿐이 저장안하면 5의 저장공간이 낭비가 된다.
    - 왜냐하면 길이를 미리 정해놓고 인스턴스 생성을 하면 메모리상에 10이라는 공간을 확보해야하기 때문
- 대신 데이터 검색이 빠르다.

`리스트 (List)` 
- 온전히 자료 구조의 관점에서 보면 리스트 안에 배열이 포함된다고 한다. 
- 하지만 언어 관점에서는 리스트가 배열이 갖고 있는 인덱스 대신 빈틈없는 데이터의 적재라고 한다.
    - 음.. 메모리 상에 데이터를 순서없이 그냥 비는 주소에 저장한다는 의미인가 ?
- 배열은 메모리의 낭비가 발생할 수 있다는 반면 리스트는 메모리를 미리 확보해놓지 않는다.
    - 대신 데이터가 저장될때 다음 주소를 참조할 수 있게 값과 주소를 같이 저장한다. (그래서 데이터 저장 순서가 연속적이지 않는듯.)
- 크기는 가변적이기 때문에 데이터를 저장할 때마다 길이가 늘어난다.
- 리스트를 보통 연결 리스트라고 보는것이 일반적이라고 한다.

> 일반적인 코드
```java
List<String> map = new ArrayList<String>();
```

- List의 종류에도 여러가지가 있다.
- 흔히 사용하는 ArrayList, LinkedList, ...



## 학습 키워드
- DAO(Data Access Object)
- List
- Map